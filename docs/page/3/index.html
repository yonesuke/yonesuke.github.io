<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.115.1"><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Ryosuke Yoneda</title>
<meta name="keywords" content="Blog, Portfolio, PaperMod">
<meta name="description" content="Ryosuke Yoneda&#39;s Homepage">
<meta name="author" content="">
<link rel="canonical" href="https://yonesuke.github.io/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://yonesuke.github.io/favicon_io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://yonesuke.github.io/favicon_io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://yonesuke.github.io/favicon_io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://yonesuke.github.io/favicon_io/apple-touch-icon.png">
<link rel="mask-icon" href="https://yonesuke.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://yonesuke.github.io/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<link rel="stylesheet" href="https://yonesuke.github.io/css/theoremproof.css">
<meta property="og:title" content="Ryosuke Yoneda" />
<meta property="og:description" content="Ryosuke Yoneda&#39;s Homepage" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://yonesuke.github.io/" /><meta property="og:image" content="https://yonesuke.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"/><meta property="og:site_name" content="Ryosuke Yoneda" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://yonesuke.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"/>

<meta name="twitter:title" content="Ryosuke Yoneda"/>
<meta name="twitter:description" content="Ryosuke Yoneda&#39;s Homepage"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Ryosuke Yoneda",
  "url": "https://yonesuke.github.io",
  "description": "Ryosuke Yoneda\u0026#39;s Homepage",
  "thumbnailUrl": "https://yonesuke.github.io/favicon_io/favicon.ico",
  "sameAs": [
      "https://twitter.com/yonesuke1729", "https://github.com/yonesuke", "https://scholar.google.com/citations?user=XN3JxqIAAAAJ", "mailto:yoneda.ryosuke.56a@st.kyoto-u.ac.jp", "cv.pdf"
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://yonesuke.github.io" accesskey="h" title="Ryosuke Yoneda&#39;s Homepage (Alt + H)">
                <img src="https://yonesuke.github.io/favicon_io/apple-touch-icon.png" alt="" aria-label="logo"
                    height="35">Ryosuke Yoneda&#39;s Homepage</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://yonesuke.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://yonesuke.github.io/research" title="Research">
                    <span>Research</span>
                </a>
            </li>
            <li>
                <a href="https://yonesuke.github.io/teaching" title="Teaching">
                    <span>Teaching</span>
                </a>
            </li>
            <li>
                <a href="https://yonesuke.github.io/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Gram行列の固有値の数値計算
    </h2>
  </header>
  <div class="entry-content">
    <p>カーネル関数$k(\cdot,\cdot)$が与えられたとき、データ点$\{x_{i}\}_{i=1}^{n}$に対するGram行列(グラム行列)は $$ K=\begin{pmatrix}k(x_{1},x_{1}) &amp; \cdots &amp; k(x_{1},x_{n})\\\vdots &amp; \ddots &amp; \vdots\\ k(x_{n},x_{1}) &amp; \cdots &amp; k(x_{n},x_{n})\end{pmatrix} $$ で与えられます。色々な場面に登場するのですが、RBFカーネルからガウス過程を生成する際にその固有値計算で詰まったところがあったのでかんたんにまとめておきます。
Gram行列の性質 カーネル関数の定義は対称性$k(x,y)=k(y,x)$が成り立ってグラム行列が(半)正定値行列になることです。すなわち、任意のベクトル$\bm{c}$に対して、 $$ \bm{c}^{\top}K\bm{c}\geq0 $$ が成り立つことです。なので、カーネル関数から生成されたGram行列は常に半正定値行列になります。 半正定値性と固有値が非負であることは同値なのでGram行列の固有値は常に非負です。
ガウス過程に従う関数の生成 次にガウス過程から関数をサンプルすることを考えましょう。$f\sim\mathcal{GP}(m,k)$について、特にかんたんのために平均を$0$としておきましょう。 このとき、$\{x_{i}\}_{i=1}^{n}$上で関数$f$のベクトル$\bm{f}$は $$ \bm{f}\sim\mathcal{N}(\bm{0},K) $$ という多次元ガウス分布に従うものになります。これはGram行列を分散共分散行列とするガウス分布で、代表的なサンプル方法は$K$のコレスキー分解行列と$n$次元の独立標準正規分布に従う乱数との行列・ベクトル積を計算することで得られます。
固有値分布とガウス過程の関係 RBFカーネルからGram行列を生成し、コレスキー分解することを考えましょう。ここでRBFカーネルは $$ k(x,y)=\exp\left(-\frac{(x-y)^{2}}{2l^{2}}\right) $$ で与えられます。Julia実装をしてみると、
1 2 3 4 using LinearAlgebra xs = -2:0.02:2 K = [exp(-(x-y)^2) for x in xs, y in xs] cholesky(K) となりますが、これを実行すると、
1 ERROR: PosDefException: matrix is not positive definite; Cholesky factorization failed. と帰ってきて、Gram行列が正定値でないと言われてしまいます。理論ではGram行列は正定値であるはずなので、これは数値的な誤差に起因していると考えられます。 そこでGram行列の固有値分布を確認してみることにします。この際、RBFカーネルだけでなく周期カーネルとMatérnカーネルについても固有値分布と対応するガウス過程のサンプルをプロットしました。この結果が次のようになります。...</p>
  </div>
  <footer class="entry-footer"><span title='2021-08-02 16:59:14 +0900 JST'>August 2, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;184 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to Gram行列の固有値の数値計算" href="https://yonesuke.github.io/posts/gram_eigen/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Laplacianの積分表現
    </h2>
  </header>
  <div class="entry-content">
    <p>領域$\Omega\subset\mathbb{R}^{n}$上で定義された関数$u\in C^{2}(\Omega)$についてLaplacian(ラプラシアン)は $$ \Delta u(x)=\sum_{i=1}^{n}\frac{\partial^{2}u}{\partial x_{i}^{2}}(x) $$ で表されます。このとき、$\partial B(x,r)=\{y\in\mathbb{R}^{n}\mid |x-y|=r\}$とおくと、 $$ \Delta u(x)=\lim_{r\to&#43;0}\frac{2n}{r^{2}|\partial B(x,r)|}\int_{\partial B(x,r)}u(y)-u(x)d\sigma_{y} $$ が成り立ちます。$d\sigma_{y}$は$\partial B(x,r)$上の面積要素です。 この表現を得るには$u(y)$を$x$まわりでTaylor展開することが大事になるのですが、 その際、平均値の定理によって得られるTaylor展開だと剰余項の評価が難しくなります。 積分型のTaylor展開を用いることでこの問題を解決することができます。
積分型のTaylor展開 はじめに多重指数$\alpha\in\mathbb{N}_{\geq 0}^{n}$を導入します。 $$ |\alpha|=\alpha_{1}&#43;\cdots&#43;\alpha_{n},\quad x^{\alpha}=x_{1}^{\alpha_{1}}\cdots x_{n}^{\alpha_{n}} $$ とし、多重指数による微分を $$ D^{\alpha}f=\frac{\partial^{|\alpha|}f}{\partial x_{1}^{\alpha_{1}}\cdots\partial x_{n}^{\alpha_{n}}} $$ とします。 このとき、関数$f$が$C^{k&#43;1}$級であるとき、点$x$まわりの積分型のTaylor展開は $$\begin{aligned}&amp;f(y)=\sum_{|\alpha|\leq k}\frac{D^{\alpha}f(x)}{\alpha!}(y-x)^{\alpha}&#43;\sum_{|\beta|=k&#43;1}R_{\beta}(y)(y-x)^{\beta},\\&amp;R_{\beta}(y)=\frac{k&#43;1}{\beta!}\int_{0}^{1}(1-t)^{k}D^{\beta}f(x&#43;t(y-x))dt\end{aligned}$$ で与えられます。このように剰余項$R_{\beta}$が積分の形で明示的に与えられるのが特徴です。 授業ではよく平均値の定理を用いた証明を習うと思うのですが、意外にこの積分型のTaylor展開が役に立つことがあるので覚えておいて損はないと思います。
証明 $u$を$x$周りで展開しましょう。$u\in C^{2}(\Omega)$なので、 $$\begin{aligned}u(y)-u(x)=&amp;\sum_{i=1}^{n}\frac{\partial u}{\partial x_{i}}(x)(y_{i}-x_{i})&#43;2\sum_{i\ne j}(y_{i}-x_{i})(y_{j}-x_{j})\int_{0}^{1}(1-t)\frac{\partial^{2}u}{\partial x_{i}\partial x_{j}}(x&#43;t(y-x))dt\\&amp;&#43;\sum_{i=1}^{n}(y_{i}-x_{i})^{2}\int_{0}^{1}(1-t)\frac{\partial^{2}u}{\partial x_{i}^{2}}(x&#43;t(y-x))dt\end{aligned}$$ です。これを積分すると、 $$\begin{aligned}\int_{\partial B(x,r)}u(y)-u(x)d\sigma_{y}=&amp;\sum_{i=1}^{n}\frac{\partial u}{\partial x_{i}}(x)\int_{\partial B(x,r)}y_{i}-x_{i}d\sigma_{y}\\&amp;&#43;2\sum_{i\ne j}\int_{\partial B(x,r)}(y_{i}-x_{i})(y_{j}-x_{j})\left[\int_{0}^{1}(1-t)\frac{\partial^{2}u}{\partial x_{i}\partial x_{j}}(x&#43;t(y-x))dt\right]d\sigma_{y}\\&amp;&#43;\sum_{i=1}^{n}\int_{\partial B(x,r)}(y_{i}-x_{i})^{2}\left[\int_{0}^{1}(1-t)\frac{\partial^{2}u}{\partial x_{i}^{2}}(x&#43;t(y-x))dt\right]d\sigma_{y}\end{aligned}$$ となります。 まず、$y_{i}-x_{i}$は$\partial B(x,r)$の奇関数なのでこの積分は$0$となります。 また、$y-x=rz,\ d\sigma_{y}=r^{n-1}d\sigma_{z}$と変数変換すると、$|\partial B(x,r)|=r^{n-1}|\partial B(0,1)|$より、 $$ \begin{aligned}&amp;\frac{2n}{r^{2}|\partial B(x,r)|}\int_{\partial B(x,r)}(y_{i}-x_{i})(y_{j}-x_{j})\left[\int_{0}^{1}(1-t)\frac{\partial^{2}u}{\partial x_{i}\partial x_{j}}(x&#43;t(y-x))\right]d\sigma_{y}\\=&amp;\frac{2n}{|\partial B(0,1)|}\int_{\partial B(0,1)}z_{i}z_{j}\left[\int_{0}^{1}(1-t)\frac{\partial^{2}u}{\partial x_{i}\partial x_{j}}(x&#43;trz)\right]d\sigma_{z}\\\to&amp;\frac{2n}{|\partial B(0,1)|}\int_{\partial B(0,1)}z_{i}z_{j}\left[\int_{0}^{1}(1-t)\frac{\partial^{2}u}{\partial x_{i}\partial x_{j}}(x)\right]d\sigma_{z}=\frac{n}{|\partial B(0,1)|}\frac{\partial^{2}u}{\partial x_{i}\partial x_{j}}(x)\int_{\partial B(0,1)}z_{i}z_{j}d\sigma_{z}\end{aligned} $$ と$r\to&#43;0$の極限で求まります。ただし極限操作の交換は優収束定理から正当化されます。 さらに、$i\ne j$ならば$z_{i}z_{j}$の積分は$0$になり、$i=j$ならば、$z_{i}^{2}$の積分は$i$に依存しないので、 $$ \frac{n}{|\partial B(0,1)|}\frac{\partial^{2}u}{\partial x_{i}^{2}}(x)\int_{\partial B(0,1)}z_{i}^{2}d\sigma_{z}=\frac{1}{|\partial B(0,1)|}\frac{\partial^{2}u}{\partial x_{i}^{2}}(x)\int_{\partial B(0,1)}\sum_{i=1}^{n}z_{i}^{2}d\sigma_{z}=\frac{\partial^{2}u}{\partial x_{i}^{2}}(x) $$ と計算できます。よって、 $$ \frac{2n}{r^{2}|\partial B(x,r)|}\int_{\partial B(x,r)}u(y)-u(x)d\sigma_{y}\to\sum_{i=1}^{n}\frac{\partial^{2}u}{\partial x_{i}^{2}}(x)=\Delta u(x) $$ となり、示されました。</p>
  </div>
  <footer class="entry-footer"><span title='2021-07-30 18:34:51 +0900 JST'>July 30, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;111 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to Laplacianの積分表現" href="https://yonesuke.github.io/posts/laplacian_integral/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Borwein integral
    </h2>
  </header>
  <div class="entry-content">
    <p>Borwein積分は$\sin x/x$に関する興味深い性質を持った積分のことです。 例えば $$ \int_{0}^{\infty}\frac{\sin x}{x}dx=\frac{\pi}{2} $$ となることはよく知られていますが、これに$\sin(3x)/3x$をかけたものについても $$ \int_{0}^{\infty}\frac{\sin x}{x}\frac{\sin (x/3)}{x/3}dx=\frac{\pi}{2} $$ が成り立ちます。同様のことは$\sin (x/5)/(x/5)$や$\sin(x/7)/(x/7)$をかけていっても成り立ち、 $$ \int_{0}^{\infty}\frac{\sin x}{x}\frac{\sin (x/3)}{x/3}\cdots\frac{\sin (x/13)}{x/13}dx=\frac{\pi}{2} $$ となります。しかし、次のステップではこの計算は崩れて $$ \int_{0}^{\infty}\frac{\sin x}{x}\frac{\sin (x/3)}{x/3}\cdots\frac{\sin (x/15)}{x/15}dx=\frac{467807924713440738696537864469}{935615849440640907310521750000}\pi&lt;\frac{\pi}{2} $$ となってしまいます。一見するとこの値も$\pi/2$になりそうなのですが、何故か値がずれてしまいます。 このような積分のことをBorwein積分とよび、いくつかの計算がなされています。
公式 数列$a_{1},a_{2},\dots,a_{n}$に対して、Borwein積分$\tau_{n}$を $$ \tau_{n}=\int_{0}^{\infty}\prod_{k=1}^{n}\frac{\sin(a_{k}x)}{a_{k}x}dx $$ で定めます。ここでは各$a_{i}$は正だとしておきます。この積分は完全に計算することができて、 $$ \tau_{n}=\frac{\pi}{2^{n&#43;1}(n-1)!\prod_{k=1}^{n}a_{k}}\sum_{p_{1},\dots,p_{n}=\pm1}p_{1}\cdots p_{n}\mathrm{sgn}\left(\bm{p}\cdot\bm{a}\right)(\bm{p}\cdot\bm{a})^{n-1} $$ となります。以下でこれを示していきます。元論文ではFourier変換による畳込み積分を用いて計算していますが、留数定理を用いた計算でも示すことができたのでそれを紹介していきます。
証明 はじめに$\sin(a_{k}x)$を展開していきます。 $$ \tau_{n}=\int_{0}^{\infty}\prod_{k=1}^{n}\frac{\sin(a_{k}x)}{a_{k}x}dx =\frac{1}{(2i)^{n}\prod_{k=1}^{n}a_{k}}\int_{0}^{\infty}\frac{\prod_{k=1}^{n}(e^{ia_{k}x}-e^{-ia_{k}x})}{x^{n}}dx $$ です。ここでパラメーター$p_{k}=\pm1$を導入して$e^{ia_{k}x}-e^{-ia_{k}x}=\sum_{p_{k}=\pm1}p_{k}e^{ip_{k}a_{k}x}$と書くと、 $$ \prod_{k=1}^{n}(e^{ia_{k}x}-e^{-ia_{k}x})=\sum_{p_{1},\dots,p_{n}=\pm1}p_{1}\cdots p_{n}e^{i\bm{p}\cdot\bm{a}x} $$ となるので、 $$ \tau_{n}=\frac{1}{(2i)^{n}\prod_{k=1}^{n}a_{k}}\sum_{p_{1},\dots,p_{n}=\pm1}p_{1}\cdots p_{n}\int_{0}^{\infty}\frac{e^{i\bm{p}\cdot\bm{a}x}}{x^{n}}dx $$ となります。
よって、$\int_{0}^{\infty}e^{iax}/x^{n}dx$が計算できれば良いです。 $a&gt;0$の場合を考えます。 被積分関数を複素平面に持ち上げて $$ f(z)=\frac{e^{iaz}}{z^{n}} $$ とします。このとき、次のような積分経路$C$を考えます。
$\gamma_{\varepsilon}$は半径$\varepsilon$の円の上半面を時計回りに回る経路で、$\Gamma_{R}$は半径$R$の上半面を反時計回りに回る経路です。 $f(z)$は$C$内で正則なので$\oint_{C}f(z)dz=0$です。 また、 $$ \oint_{C}=\int_{-R}^{-\varepsilon}&#43;\int_{\gamma_{\varepsilon}}&#43;\int_{\varepsilon}^{R}&#43;\int_{\Gamma_{R}} $$ です。...</p>
  </div>
  <footer class="entry-footer"><span title='2021-07-13 02:20:20 +0900 JST'>July 13, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;259 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to Borwein integral" href="https://yonesuke.github.io/posts/borwein/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>特異値分解
    </h2>
  </header>
  <div class="entry-content">
    <p>行列$A$を$m\times n$の実行列とします。 このときある直交行列$U\in\mathbb{R}^{m\times m},V\in\mathbb{R}^{n\times n}$が存在して、 $$U^{\mathsf{T}}AV=\Sigma=\begin{pmatrix}\mathrm{diag}(\sigma_{1},\dots,\sigma_{r}) &amp; O_{r\times(n-r)} \\ O_{(m-r)\times r} &amp; O_{(m-r)\times (n-r)}\end{pmatrix}\in\mathbb{R}^{m\times n}$$ となるようにできます。このような分解を特異値分解と言います。
証明 $A^{\mathsf{T}}A$は実対称行列なので固有ベクトル${v_{1},\dots,v_{n}}$と固有値${\xi_{1},\dots,\xi_{n}}$が存在して $$ A^{\mathsf{T}}Av_{i}=\xi_{i}v_{i},\quad (v_{i},v_{j})=\delta_{ij} $$ となるようにできます。 また、 $$ \xi_{i}=(v_{i},\xi_{i}v_{i})=(v_{i},A^{\mathsf{T}}Av_{i})=(Av_{i},Av_{i})\geq0 $$ なので固有値は常に0以上です。特に、$i=1,\dots,r$で$\xi_{i}&gt;0$かつ$i&gt;r$で$\xi_{i}=0$となるようにしておきます。 実はこの固有ベクトル$v_{i}$たちが直交行列$V$に対応します。
次に$i=1,2,\dots,r$に対して$u_{i}=Av_{i}/\sqrt{\xi_{i}}$としましょう。すると、 $$ (u_{i}, u_{j})=\frac{1}{\sqrt{\xi_{i}\xi_{j}}}(Av_{i},Av_{j})=\frac{1}{\sqrt{\xi_{i}\xi_{j}}}(v_{i},A^{\mathsf{T}}Av_{j})=\frac{\xi_{j}\delta_{ij}}{\sqrt{\xi_{i}\xi_{j}}}=\delta_{ij} $$ となり、$u_{i}$たちは互いに直交します。このとき$m-r$個のベクトル${u_{r&#43;1},\dots,u_{m}}$を持ってきて正規直交基底${u_{1},\dots,u_{m}}$を構成することができます。 実はこのベクトル$u_{i}$たちが直交行列$U$に対応します。
上で得られたベクトルを用いて行列 $$ V=(v_{1},\dots,v_{n}),\quad U=(u_{1},\dots,u_{m}) $$ を構成します。これが直交行列なのは明らかです。 $U^{\mathsf{T}}AV$という行列を計算してみると、 $$ U^{\mathsf{T}}AV[i,j]=(u_{i},Av_{j}) $$ となります。
$j=r&#43;1,\dots,n$においては $$ (Av_{j},Av_{j})=(v_{j},A^{\mathsf{T}}Av_{j})=(v_{j},0)=0 $$ なので$(u_{i},Av_{j})=0$となります。 $i=r&#43;1,\dots,m$かつ$j=1,\dots,r$においても $$ (u_{i},Av_{j})=(u_{i},\sqrt{\xi_{j}}u_{j})=0 $$ となります。 $1\leq i,j\leq r$のときには、 $$ (u_{i},Av_{j})=(u_{i},\sqrt{\xi_{j}}u_{j})=\sqrt{\xi_{j}}\delta_{ij} $$ となります。 よって、$\sqrt{\xi_{i}}=\sigma_{i}$と置くことで $$U^{\mathsf{T}}AV=\Sigma=\begin{pmatrix}\mathrm{diag}(\sigma_{1},\dots,\sigma_{r}) &amp; O_{r\times(n-r)} \\ O_{(m-r)\times r} &amp; O_{(m-r)\times (n-r)}\end{pmatrix}$$ となることが示されました。 特に$A=U\Sigma V^{\mathsf{T}}$もわかります。...</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-31 16:22:52 +0900 JST'>May 31, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;130 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to 特異値分解" href="https://yonesuke.github.io/posts/svd/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Good Will Hunting Problem
    </h2>
  </header>
  <div class="entry-content">
    <p>マット・デイモンとロビン・ウィリアムズ主演の映画『グッド・ウィル・ハンティング/旅立ち』(Good Will Hunting)の中で、MITの廊下に掲示されたグラフ理論の問題を清掃をしていたマット・デイモンが解いてしまうシーンがあります。 中学生とかのときに初めてこの映画を見たときにはよっぽど難しい問題なんだろうな、と思ったのですが、最近見返してみると定義に従って素直に計算すれば解ける問題だということがわかったのでまとめておきます。
Given the graph $G$, find
The adjacency matrix, $A$ The matrix giving the number of 3 step walks The generating function for walks from $i\to j$ The generating function for walks from $1\to3$ 問1 グラフの隣接行列$A$の$(i,j)$成分は$i$から$j$に向かう枝があれば$1$、そうでなければ$0$となるように定義されています。 今の場合、頂点$3$と頂点$4$の間には2本枝があるのでその場合は重み付きの枝だと思って$2$とします。 そうすると隣接行列は、 $$ A= \begin{pmatrix} 0 &amp; 1 &amp; 0 &amp; 1\\1 &amp; 0 &amp; 2 &amp; 1\\0 &amp; 2 &amp; 0 &amp; 0\\1 &amp; 1 &amp; 0 &amp; 0 \end{pmatrix} $$ となります。...</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-31 13:01:31 +0900 JST'>May 31, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;244 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to Good Will Hunting Problem" href="https://yonesuke.github.io/posts/good-will-hunting/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>至るところ微分不可能な連続関数: 初等的な構成方法
    </h2>
  </header>
  <div class="entry-content">
    <p>$[-1,1]$上の関数 $$ \varphi(x)=|x| $$ を考え、 これを$\varphi(x&#43;2)=\varphi(x)$として$\mathbb{R}$上へ拡張します。 このとき、 $$ f(x)=\sum_{n=0}^{\infty}\left(\frac{3}{4}\right)^{n}\varphi(4^{n}x) $$ は$\mathbb{R}$上の連続関数ですが至るところ微分不可能であることが知られています。 以下でこれを示していきましょう。
連続であること 連続であることの証明はかんたんです。 $$ f_{k}(x)=\sum_{n=0}^{k}\left(\frac{3}{4}\right)^{n}\varphi(4^{n}x) $$ とおくと、$f_{k}$は連続関数です。 $$ |f(x)-f_{k}(x)|\leq\sum_{n=k&#43;1}^{\infty}\left(\frac{3}{4}\right)^{n}=4\left(\frac{3}{4}\right)^{k&#43;1} $$ となるので、$x$によらずに一様に抑えることができます。 これは連続関数$f_{k}$が$f$に一様収束していることを表します。 連続関数の一様収束極限は連続関数なので$f$は連続関数です。
微分不可能であること 任意の$x_{0}\in\mathbb{R}$を一つ固定しましょう。 $m\in\mathbb{N}$に対して、$\delta_{m}=\pm\frac{1}{2}4^{-m}$とおき、 符号は$4^{m}x_{0}$と$4^{m}(x_{0}&#43;\delta_{m})$の間に整数が来ないようにします。 $$ \gamma_{n}=\frac{\varphi(4^{n}(x_{0}&#43;\delta_{m}))-\varphi(4^{n}x_{0})}{\delta_{m}} $$ という値を計算してみましょう。
$n&gt;m$のときには$4^{n}\delta_{m}$は$2$の倍数となります。 $\varphi(x)$が周期$2$の関数であることを思い出すと、$\gamma_{n}=0$がわかります。 $n=m$のときには$4^{m}x_{0}$と$4^{m}(x_{0}&#43;\delta_{m})$の間に整数が来ないので、 $|\gamma_{m}|=|4^{m}\delta_{m}/\delta_{m}|=4^{m}$となります。 $n &lt; m$のときには、一般に$|\varphi(x)-\varphi(y)|\leq|x-y|$なので、 $|\gamma_{n}|\leq4^{n}$がわかります。 以上の準備のもと$f$が微分不可能であることを示しましょう。 具体的には、上で定義した$\delta_{m}$を用いて、$x_{0}&#43;\delta_{m}\to x_{0}$の極限で微分が発散することを確認します。 $$ \left|\frac{f(x_{0}&#43;\delta_{m})-f(x_{0})}{\delta_{m}}\right| =\left|\sum_{n=0}^{\infty}\left(\frac{3}{4}\right)^{n}\frac{\varphi(4^{n}(x_{0}&#43;\delta_{m}))-\varphi(4^{n}x_{0})}{\delta_{m}}\right| =\left|\sum_{n=0}^{\infty}\left(\frac{3}{4}\right)^{n}\gamma_{n}\right| $$ となりますが、$\gamma_{n}$が$n&gt;m$で消えること、また$|x&#43;y|\geq|x|-|y|$であることを用いると、 $$\begin{aligned}\left|\sum_{n=0}^{\infty}\left(\frac{3}{4}\right)^{n}\gamma_{n}\right|=&amp;\left|\sum_{n=0}^{m}\left(\frac{3}{4}\right)^{n}\gamma_{n}\right|\\=&amp;\left|\left(\frac{3}{4}\right)^{m}\gamma_{m}&#43;\sum_{n=0}^{m-1}\left(\frac{3}{4}\right)^{n}\gamma_{n}\right|\\\geq&amp;\left(\frac{3}{4}\right)^{m}|\gamma_{m}|-\left|\sum_{n=0}^{m-1}\left(\frac{3}{4}\right)^{n}\gamma_{n}\right|\\\geq&amp;3^{m}-\sum_{n=0}^{m-1}3^{m}=\frac{1}{2}(3^{m}&#43;1)\to\infty\end{aligned}$$ となり、$\delta_{m}$を用いた点列の収束だと微分が発散することがわかります。 よって$f$が微分不可能であることを示すことができました。
グラフの概形 $f$自身は無限和で定義されているためプロットすることはできません。 その代わりに$f_{k}$をプロットすることにしました。 そのときのpythonファイルです。
$ k = 0,1,3,10 $の場合の$ f _ {k} $をプロットしたものが次のようになります。
$f_{0}$は$\varphi$にほかなりません。 $f_{1}$は$\varphi(4x)$によって引き伸ばされたものを足し込むことによって微分不可能な点が新たに増えていることがわかります。 このように$\varphi(4^{m}x)$によって微分不可能点が$\mathbb{R}$全体に伝播していって最終的に$f$が微分不可能になる様子が確認できます。</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-30 09:56:32 +0900 JST'>May 30, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;68 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to 至るところ微分不可能な連続関数: 初等的な構成方法" href="https://yonesuke.github.io/posts/nowherediff/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>坂口-蔵本モデルのダイナミクス
    </h2>
  </header>
  <div class="entry-content">
    <p>坂口-蔵本モデルは蔵本モデルにphase lagを導入したモデルで、次の微分方程式で表されます。 $$ \frac{d\theta_{i}}{dt}=\omega_{i}&#43;\frac{K}{N}\sum_{j=1}^{N}\sin(\theta_{j}-\theta_{i}&#43;\alpha),\quad i=1,\dots,N. $$ $\alpha$が位相差に対応していて、$\alpha=0$のときは蔵本モデルに戻ります。 結合強度$K$が変化したときに振動子が同期するかどうかを調べていきましょう。
自然振動数分布 各振動子は固有の角速度である$\omega_{i}$を持っています。 蔵本モデル関連の論文では$\omega_{i}$は分布に従っていると仮定しています。 この分布のことを自然振動数分布と呼びます。 分布としてはGauss分布を選ぶのかと思いきや、蔵本モデルにおいては解析のしやすさからCauchy分布が選ばれています。 $$ g(\omega)=\frac{\Delta}{\pi}\frac{1}{(\omega-\omega_{0})^{2}&#43;\Delta^{2}} $$ $\omega_{0}$は分布の中心で、$\Delta$は分布の幅を表します。 このページでもCauchy分布を用いることにします。
秩序変数 同期の具合をはかるパラメーターとして秩序変数(order parameter)を導入します。 $$ z=re^{i\phi}=\frac{1}{N}\sum_{j=1}^{N}e^{i\theta_{j}} $$
$r\approx0$のときは振動子たちは円周上をバラバラに分布しているため、同期していないことがわかります。 $r=1$のときには振動子たちは円周上の1点に集中しているため、完全同期しています。 連続極限 振動子が無限個ある極限$N\to\infty$において、微分方程式は連続の式に従います。 $$ \frac{\partial f}{\partial t}&#43;\frac{\partial}{\partial\theta}(V[f]f)=0 $$ ここで$V[f]$は速度場で微分方程式を無限に飛ばした式になります。 $$ V[f]=\omega&#43;K\int_{\mathbb{R}}d\omega’\int_{\mathbb{S}^{1}}d\theta’ f(\theta’,\omega’,t)\sin(\theta’-\theta&#43;\alpha) $$
$f(\theta,\omega,t)$は時刻$t$における$\theta,\omega$の密度関数になります。 すなわち、$[\theta,\theta&#43;\delta\theta)\times[\omega,\omega&#43;\delta\omega)$に存在する振動子の割合が $f(\theta,\omega,t)\delta\theta\delta\omega$になります。 $\omega$は$g(\omega)$に従うので、 $$ \int_{\mathbb{S}^{1}}d\theta f(\theta,\omega,t)=g(\omega) $$ が成り立ちます。 連続極限において秩序変数は $$ z=re^{i\phi}=\int_{\mathbb{R}}d\omega\int_{\mathbb{S}^{1}}d\theta f(\theta,\omega,t)e^{i\theta} $$ となります。 Fourier級数展開 分布関数$f(\theta,\omega,t)$について、$\theta$方向は$\mathbb{S}^{1}$に乗っているのでFourier級数展開ができます。 $$ f(\theta,\omega,t)=\frac{1}{2\pi}\sum_{k\in\mathbb{Z}}\hat{f} _ {k}(\omega,t)e^{-ik\theta} $$ これをもとに連続の式もFourier級数展開しましょう。 かんたんのために$h(\omega)$の$\omega$積分を$\langle h\rangle$と書くことにします。 $$ \begin{aligned}V[f]=&amp;\omega&#43;\frac{Ke^{-i(\theta-\alpha)}}{2i}\int_{\mathbb{R}}d\omega’\int_{\mathbb{S}^{1}}d\theta’ f(\theta’,\omega’,t)e^{i\theta’}-\frac{Ke^{i(\theta-\alpha)}}{2i}\int_{\mathbb{R}}d\omega’\int_{\mathbb{S}^{1}}d\theta’ f(\theta’,\omega’,t)e^{-i\theta’}\\=&amp;\omega&#43;\frac{Ke^{-i(\theta-\alpha)}}{2i}\langle\hat{f} _ {1}\rangle-\frac{Ke^{i(\theta-\alpha)}}{2i}\langle\hat{f} _ {-1}\rangle \end{aligned}$$ であるので、 $$ \widehat{V[f]} _ {0}=2\pi\omega,\widehat{V[f]} _ {-1}=i\pi Ke^{-i\alpha}\langle\hat{f} _ {-1}\rangle,\widehat{V[f]} _ {1}=-i\pi Ke^{i\alpha}\langle\hat{f} _ {1}\rangle $$ がわかります。 これを連続の式に代入することで、 $$ \begin{aligned} \frac{\partial\hat{f} _ {k}}{\partial t}=&amp;-\widehat{\frac{\partial}{\partial\theta}(V[f]f)} _ {k}=ik\widehat{V[f]f} _ {k}=\frac{ik}{2\pi}\left(\sum_{l\in\mathbb{Z}}\widehat{V[f]} _ {l}\hat{f} _ {k-l}\right)=\frac{ik}{2\pi}\left(\sum_{l=0,\pm1}\widehat{V[f]} _ {l}\hat{f} _ {k-l}\right)\\=&amp;ik\omega\hat{f} _ {k}&#43;\frac{kKe^{i\alpha}}{2}\langle\hat{f} _ {1}\rangle\hat{f} _ {k-1}-\frac{kKe^{-i\alpha}}{2}\langle\hat{f} _ {-1}\rangle\hat{f} _ {k&#43;1} \end{aligned} $$ となります。特に秩序変数が$z=\langle\hat{f} _ {1}\rangle$で書けるので、 $$ \frac{\partial\hat{f} _ {k}}{\partial t}=ik\omega\hat{f} _ {k}&#43;\frac{kKe^{i\alpha}z}{2}\hat{f} _ {k-1}-\frac{kKe^{-i\alpha}\overline{z}}{2}\hat{f} _ {k&#43;1} $$ とさらに簡略化して書くことができます。 この偏微分方程式を解くことができればダイナミクスの理解が進むのですが、 このままでは難しいです。 この難しさを乗り越えたのがOtt-Antonsen縮約と呼ばれるものがあって、この偏微分方程式の特解を表します。...</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-28 13:32:31 +0900 JST'>May 28, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;217 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to 坂口-蔵本モデルのダイナミクス" href="https://yonesuke.github.io/posts/sakaguchi-kuramoto/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>包除原理
    </h2>
  </header>
  <div class="entry-content">
    <p>測度空間$(X,\mathcal{B},\mu)$の有限測度集合$A_{i}(i=1,\dots,n)$に対して $$ \mu\left(\bigcup_{i=1}^{n}A_{i}\right)=\sum_{J\subset[n];J\ne\emptyset}(-1)^{|J|-1}\mu\left(\bigcap_{i\in J}A_{i}\right) $$ が成り立ちます。これを包除原理(Inclusion-exclusion principle)と呼びます。
証明 証明は $$ \int_{X}\left(1-\prod_{i=1}^{n}(1-1_{A_{i}})\right)d\mu $$ を二通りに計算することにより求まります。
はじめに愚直に展開してみることにします。 $$ \prod_{i=1}^{n}(1-x_{i})=\sum_{J\subset[n]}(-1)^{|J|}\prod_{i\in J}x_{i} $$ は展開すればわかるので、この$x_{i}$に$1_{A_{i}}$を代入すると、 $$ 1-\prod_{i=1}^{n}(1-1_{A_{i}})=1-\sum_{J\subset[n]}(-1)^{|J|}\prod_{i\in J}1_{A_{i}} =\sum_{J\subset[n];J\ne\emptyset}(-1)^{|J|-1}1_{\bigcap_{i\in J}A_{i}} $$ となります。ここで$1_{A}1_{B}=1_{A\cap B}$を用いました。以上より、 $$ \int_{X}\left(1-\prod_{i=1}^{n}(1-1_{A_{i}})\right)d\mu = \sum_{J\subset[n];J\ne\emptyset}(-1)^{|J|-1}\mu\left(\bigcap_{i\in J}A_{i}\right) $$ がわかります。これで包除原理の右辺が示されました。
次に賢い計算をしましょう。$1-1_{A}=1_{\overline{A}}$なので、 $$ 1-\prod_{i=1}^{n}(1-1_{A_{i}})=1-\prod_{i=1}^{n}1_{\overline{A_{i}}}=1-1_{\bigcap_{i=1}^{n}\overline{A_{i}}} =1_{\overline{\bigcap_{i=1}^{n}\overline{A_{i}}}} =1_{\bigcup_{i=1}^{n}A_{i}}$$ となります。最後にドモルガンの法則を用いました。 よって、 $$ \int_{X}\left(1-\prod_{i=1}^{n}(1-1_{A_{i}})\right)d\mu =\int_{X} 1_{\bigcup_{i=1}^{n}A_{i}}d\mu = \mu\left(\bigcup_{i=1}^{n}A_{i}\right) $$ となります。 これで包除原理の左辺が導かれ、包除原理が示されました。</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-16 12:18:18 +0900 JST'>May 16, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;50 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to 包除原理" href="https://yonesuke.github.io/posts/inclusion_exclusion/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>ガウス過程に関する文献
    </h2>
  </header>
  <div class="entry-content">
    <p>ガウス過程とその機械学習への応用に関する文献はたくさんあります。ここで特に有用だと思ったものを紹介していきます。
ガウス過程全般 ガウス過程と機械学習
ガウス過程と機械学習に関する和書です。非常にわかりやすい本でこの本を読めば一通りの実装はできるようになると思います。一冊目としてはこの本で間違いない気がします。
Gaussian Processes for Machine Learning
ガウス過程と機械学習への適用に関する代表的な本だと思います。PDFはオンラインで読むことができます。
ガウス過程の数学的な基礎に関する文献 Gaussian Processes and Kernel Methods: A Review on Connections and Equivalences
ガウス過程はカーネル法と切っても切り離せない関係にあります。この論文ではカーネル法との関係に関する結果を簡潔にまとめていて非常に参考になります。例えばRBFカーネルによって生成されるサンプルの関数が確率1で$C^{\infty}$級のなめらかな関数になることはよく知られていますが、その証明の流れもこの論文を読めばわかります。
Reproducing Kernel Hilbert Spaces in Probability and Statistics
再生核ヒルベルト空間(RKHS)に関する本です。ガウス過程によって出力される関数が属する空間について議論する際にRKHSが出てきます。この本ではRKHSに関する議論やそのガウス過程との関係についても議論されています。この本の一番最後にカーネル関数とその対応するRKHSの具体例が27個載っていて圧巻です。
補助変数法 データが$N$個あるときにガウス過程回帰を行うと、データ数に応じた逆行列計算が必要で$O(N^{3})$の計算量がかかってしまいます。 データ数が非常に多くなったときにはこの計算量は現実的ではないので補助変数法と呼ばれるものを用いて計算量を削減する試みが行われています。
A Unifying View of Sparse Approximate Gaussian Process Regression
2005年に出た論文ですが、その時までに出ていた補助変数法の様々な手法をまとめた論文になっています。上で紹介した「ガウス過程と機械学習」ではこの中のFITCと呼ばれる方法が紹介されています。
Gaussian processes for Big data
変分ベイズ法を用いてガウス過程回帰を行う手法についてまとまった論文です。補助変数の配置などを含めたハイパーパラメーターの最適化が可能になります。
深層学習との関係 Deep Neural Networks as Gaussian Processes
各層のunit数を無限に飛ばしたニューラルネットワークがガウス過程に対応する、という話です。中間層が一層の場合の話は昔に知られていましたが、多層の場合もそうだそうです。紹介しておきながら腰を据えて読んだことはないのでちゃんと読みたいです。</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-06 12:53:12 +0900 JST'>May 6, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;59 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to ガウス過程に関する文献" href="https://yonesuke.github.io/posts/gp-articles/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>LaTeXの設定
    </h2>
  </header>
  <div class="entry-content">
    <p>$\LaTeX$で文章を書くときによく行う設定をまとめておきます。
Overleaf Overleafで日本語で文章を書く場合は次のlatexmkrcというファイルをおいておきます。 1 2 3 4 5 $latex = &#39;platex&#39;; $bibtex = &#39;pbibtex&#39;; $dvipdf = &#39;dvipdfmx %O -o %D %S&#39;; $makeindex = &#39;mendex -U %O -o %D %S&#39;; $pdf_mode = 3; さらにCompilerはLaTeXにしておきましょう。 Beamer LaTeXでスライド生成する際に使われるbeamerです。テーマがたくさんあるので好みのものを選ぶと良いと思います。特にmetropolisとfocusというテーマが気に入っています。 1 2 3 4 5 6 7 \documentclass[dvipdfmx]{beamer} \usepackage{bxdpx-beamer} \usepackage{pxjahyper} \usepackage{minijs} \usetheme[numbering=fraction,block=fill,progressbar=frametitle]{metropolis} \usefonttheme{professionalfonts} \usepackage{appendixnumberbeamer} Appendixに移行する際の区切りのページには次を書くと便利です。 1 2 3 4 5 6 7 8 % スライド終わり \appendix \begin{frame}[standout] APPENDIX \end{frame} % アペンディクスはじまり % \begin{frame} % ... 便利Package hyperref 次のオプションとともに呼ぶと便利です。...</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-05 18:46:29 +0900 JST'>May 5, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;102 words&nbsp;·&nbsp;Ryosuke Yoneda</footer>
  <a class="entry-link" aria-label="post link to LaTeXの設定" href="https://yonesuke.github.io/posts/latex-setup/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://yonesuke.github.io/page/2/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="https://yonesuke.github.io/page/4/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://yonesuke.github.io">Ryosuke Yoneda</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
