<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Gram行列の固有値の数値計算 | Ryosuke Yoneda&#39;s Homepage</title>
  <meta name="description" content="Hugo is a general-purpose website framework. Technically speaking, Hugo is a static site generator. Unlike systems that dynamically build a page with each visitor request, Hugo builds pages when you create or update your content. Since websites are viewed far more often than they are edited, Hugo is designed to provide an optimal viewing experience for your website’s end users and an ideal writing experience for website authors.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Gram行列の固有値の数値計算" />
<meta property="og:description" content="カーネル関数$k(\cdot,\cdot)$が与えられたとき、データ点$\{x_{i}\}_{i=1}^{n}$に対するGram行列(グラム行列)は $$ K=\begin{pmatrix}k(x_{1},x_{1}) &amp; \cdots &amp; k(x_{1},x_{n})\\\vdots &amp; \ddots &amp; \vdots\\ k(x_{n},x_{1}) &amp; \cdots &amp; k(x_{n},x_{n})\end{pmatrix} $$ で与えられます。色々な場面に登場するのですが、RBFカーネルからガウス過程を生成する際にその固有値計算で詰まったところがあったのでかんたんにまとめておきます。
Gram行列の性質 カーネル関数の定義は対称性$k(x,y)=k(y,x)$が成り立ってグラム行列が(半)正定値行列になることです。すなわち、任意のベクトル$\bm{c}$に対して、 $$ \bm{c}^{\top}K\bm{c}\geq0 $$ が成り立つことです。なので、カーネル関数から生成されたGram行列は常に半正定値行列になります。 半正定値性と固有値が非負であることは同値なのでGram行列の固有値は常に非負です。
ガウス過程に従う関数の生成 次にガウス過程から関数をサンプルすることを考えましょう。$f\sim\mathcal{GP}(m,k)$について、特にかんたんのために平均を$0$としておきましょう。 このとき、$\{x_{i}\}_{i=1}^{n}$上で関数$f$のベクトル$\bm{f}$は $$ \bm{f}\sim\mathcal{N}(\bm{0},K) $$ という多次元ガウス分布に従うものになります。これはGram行列を分散共分散行列とするガウス分布で、代表的なサンプル方法は$K$のコレスキー分解行列と$n$次元の独立標準正規分布に従う乱数との行列・ベクトル積を計算することで得られます。
固有値分布とガウス過程の関係 RBFカーネルからGram行列を生成し、コレスキー分解することを考えましょう。ここでRBFカーネルは $$ k(x,y)=\exp\left(-\frac{(x-y)^{2}}{2l^{2}}\right) $$ で与えられます。Julia実装をしてみると、
using LinearAlgebra xs = -2:0.02:2 K = [exp(-(x-y)^2) for x in xs, y in xs] cholesky(K) となりますが、これを実行すると、
ERROR: PosDefException: matrix is not positive definite; Cholesky factorization failed. と帰ってきて、Gram行列が正定値でないと言われてしまいます。理論ではGram行列は正定値であるはずなので、これは数値的な誤差に起因していると考えられます。 そこでGram行列の固有値分布を確認してみることにします。この際、RBFカーネルだけでなく周期カーネルとMatérnカーネルについても固有値分布と対応するガウス過程のサンプルをプロットしました。この結果が次のようになります。
 固有値分布については降順にソートしたものの絶対値をとったものをプロットしています。ガウス過程のサンプル方法については後述します。
RBFカーネルと周期カーネルの固有値分布に着目すると、指数的な減衰の後、途中で$0$を横切って負の値をとっていることが確認できます。これは固有値が非常に小さく、数値的な誤差によって負だと出力してしまったケースだと考えることができます。一方で、Matérnカーネルの固有値分布に着目すると、ベキ的な減衰が起こっており、負の値を取る等の誤差が見られるわけではありません。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yonesuke.github.io/posts/gram_eigen/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-02T16:59:14&#43;09:00" />
<meta property="article:modified_time" content="2021-08-02T16:59:14&#43;09:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Gram行列の固有値の数値計算"/>
<meta name="twitter:description" content="カーネル関数$k(\cdot,\cdot)$が与えられたとき、データ点$\{x_{i}\}_{i=1}^{n}$に対するGram行列(グラム行列)は $$ K=\begin{pmatrix}k(x_{1},x_{1}) &amp; \cdots &amp; k(x_{1},x_{n})\\\vdots &amp; \ddots &amp; \vdots\\ k(x_{n},x_{1}) &amp; \cdots &amp; k(x_{n},x_{n})\end{pmatrix} $$ で与えられます。色々な場面に登場するのですが、RBFカーネルからガウス過程を生成する際にその固有値計算で詰まったところがあったのでかんたんにまとめておきます。
Gram行列の性質 カーネル関数の定義は対称性$k(x,y)=k(y,x)$が成り立ってグラム行列が(半)正定値行列になることです。すなわち、任意のベクトル$\bm{c}$に対して、 $$ \bm{c}^{\top}K\bm{c}\geq0 $$ が成り立つことです。なので、カーネル関数から生成されたGram行列は常に半正定値行列になります。 半正定値性と固有値が非負であることは同値なのでGram行列の固有値は常に非負です。
ガウス過程に従う関数の生成 次にガウス過程から関数をサンプルすることを考えましょう。$f\sim\mathcal{GP}(m,k)$について、特にかんたんのために平均を$0$としておきましょう。 このとき、$\{x_{i}\}_{i=1}^{n}$上で関数$f$のベクトル$\bm{f}$は $$ \bm{f}\sim\mathcal{N}(\bm{0},K) $$ という多次元ガウス分布に従うものになります。これはGram行列を分散共分散行列とするガウス分布で、代表的なサンプル方法は$K$のコレスキー分解行列と$n$次元の独立標準正規分布に従う乱数との行列・ベクトル積を計算することで得られます。
固有値分布とガウス過程の関係 RBFカーネルからGram行列を生成し、コレスキー分解することを考えましょう。ここでRBFカーネルは $$ k(x,y)=\exp\left(-\frac{(x-y)^{2}}{2l^{2}}\right) $$ で与えられます。Julia実装をしてみると、
using LinearAlgebra xs = -2:0.02:2 K = [exp(-(x-y)^2) for x in xs, y in xs] cholesky(K) となりますが、これを実行すると、
ERROR: PosDefException: matrix is not positive definite; Cholesky factorization failed. と帰ってきて、Gram行列が正定値でないと言われてしまいます。理論ではGram行列は正定値であるはずなので、これは数値的な誤差に起因していると考えられます。 そこでGram行列の固有値分布を確認してみることにします。この際、RBFカーネルだけでなく周期カーネルとMatérnカーネルについても固有値分布と対応するガウス過程のサンプルをプロットしました。この結果が次のようになります。
 固有値分布については降順にソートしたものの絶対値をとったものをプロットしています。ガウス過程のサンプル方法については後述します。
RBFカーネルと周期カーネルの固有値分布に着目すると、指数的な減衰の後、途中で$0$を横切って負の値をとっていることが確認できます。これは固有値が非常に小さく、数値的な誤差によって負だと出力してしまったケースだと考えることができます。一方で、Matérnカーネルの固有値分布に着目すると、ベキ的な減衰が起こっており、負の値を取る等の誤差が見られるわけではありません。"/>

  
  
    
  
  
  <link rel="stylesheet" href="https://yonesuke.github.io/css/style-classic.css">
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://yonesuke.github.io/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/about">About</a></li>
         
        <li><a href="/research">Research</a></li>
         
        <li><a href="/teaching">Teaching</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/cv.pdf">CV</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://yonesuke.github.io/posts/laplacian_integral/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://yonesuke.github.io/posts/mnist_mlp/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&text=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&title=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&is_video=false&description=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97&body=Check out this article: https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&title=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&title=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&name=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97&description=%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e9%96%a2%e6%95%b0%24k%28%5ccdot%2c%5ccdot%29%24%e3%81%8c%e4%b8%8e%e3%81%88%e3%82%89%e3%82%8c%e3%81%9f%e3%81%a8%e3%81%8d%e3%80%81%e3%83%87%e3%83%bc%e3%82%bf%e7%82%b9%24%5c%7bx_%7bi%7d%5c%7d_%7bi%3d1%7d%5e%7bn%7d%24%e3%81%ab%e5%af%be%e3%81%99%e3%82%8bGram%e8%a1%8c%e5%88%97%28%e3%82%b0%e3%83%a9%e3%83%a0%e8%a1%8c%e5%88%97%29%e3%81%af%20%24%24%20K%3d%5cbegin%7bpmatrix%7dk%28x_%7b1%7d%2cx_%7b1%7d%29%20%26amp%3b%20%5ccdots%20%26amp%3b%20k%28x_%7b1%7d%2cx_%7bn%7d%29%5c%5c%5cvdots%20%26amp%3b%20%5cddots%20%26amp%3b%20%5cvdots%5c%5c%20k%28x_%7bn%7d%2cx_%7b1%7d%29%20%26amp%3b%20%5ccdots%20%26amp%3b%20k%28x_%7bn%7d%2cx_%7bn%7d%29%5cend%7bpmatrix%7d%20%24%24%20%e3%81%a7%e4%b8%8e%e3%81%88%e3%82%89%e3%82%8c%e3%81%be%e3%81%99%e3%80%82%e8%89%b2%e3%80%85%e3%81%aa%e5%a0%b4%e9%9d%a2%e3%81%ab%e7%99%bb%e5%a0%b4%e3%81%99%e3%82%8b%e3%81%ae%e3%81%a7%e3%81%99%e3%81%8c%e3%80%81RBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%8b%e3%82%89%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%82%92%e7%94%9f%e6%88%90%e3%81%99%e3%82%8b%e9%9a%9b%e3%81%ab%e3%81%9d%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e8%a8%88%e7%ae%97%e3%81%a7%e8%a9%b0%e3%81%be%e3%81%a3%e3%81%9f%e3%81%a8%e3%81%93%e3%82%8d%e3%81%8c%e3%81%82%e3%81%a3%e3%81%9f%e3%81%ae%e3%81%a7%e3%81%8b%e3%82%93%e3%81%9f%e3%82%93%e3%81%ab%e3%81%be%e3%81%a8%e3%82%81%e3%81%a6%e3%81%8a%e3%81%8d%e3%81%be%e3%81%99%e3%80%82%0aGram%e8%a1%8c%e5%88%97%e3%81%ae%e6%80%a7%e8%b3%aa%20%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e9%96%a2%e6%95%b0%e3%81%ae%e5%ae%9a%e7%be%a9%e3%81%af%e5%af%be%e7%a7%b0%e6%80%a7%24k%28x%2cy%29%3dk%28y%2cx%29%24%e3%81%8c%e6%88%90%e3%82%8a%e7%ab%8b%e3%81%a3%e3%81%a6%e3%82%b0%e3%83%a9%e3%83%a0%e8%a1%8c%e5%88%97%e3%81%8c%28%e5%8d%8a%29%e6%ad%a3%e5%ae%9a%e5%80%a4%e8%a1%8c%e5%88%97%e3%81%ab%e3%81%aa%e3%82%8b%e3%81%93%e3%81%a8%e3%81%a7%e3%81%99%e3%80%82%e3%81%99%e3%81%aa%e3%82%8f%e3%81%a1%e3%80%81%e4%bb%bb%e6%84%8f%e3%81%ae%e3%83%99%e3%82%af%e3%83%88%e3%83%ab%24%5cbm%7bc%7d%24%e3%81%ab%e5%af%be%e3%81%97%e3%81%a6%e3%80%81%20%24%24%20%5cbm%7bc%7d%5e%7b%5ctop%7dK%5cbm%7bc%7d%5cgeq0%20%24%24%20%e3%81%8c%e6%88%90%e3%82%8a%e7%ab%8b%e3%81%a4%e3%81%93%e3%81%a8%e3%81%a7%e3%81%99%e3%80%82%e3%81%aa%e3%81%ae%e3%81%a7%e3%80%81%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e9%96%a2%e6%95%b0%e3%81%8b%e3%82%89%e7%94%9f%e6%88%90%e3%81%95%e3%82%8c%e3%81%9fGram%e8%a1%8c%e5%88%97%e3%81%af%e5%b8%b8%e3%81%ab%e5%8d%8a%e6%ad%a3%e5%ae%9a%e5%80%a4%e8%a1%8c%e5%88%97%e3%81%ab%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%e3%80%82%20%e5%8d%8a%e6%ad%a3%e5%ae%9a%e5%80%a4%e6%80%a7%e3%81%a8%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%8c%e9%9d%9e%e8%b2%a0%e3%81%a7%e3%81%82%e3%82%8b%e3%81%93%e3%81%a8%e3%81%af%e5%90%8c%e5%80%a4%e3%81%aa%e3%81%ae%e3%81%a7Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%af%e5%b8%b8%e3%81%ab%e9%9d%9e%e8%b2%a0%e3%81%a7%e3%81%99%e3%80%82%0a%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%ab%e5%be%93%e3%81%86%e9%96%a2%e6%95%b0%e3%81%ae%e7%94%9f%e6%88%90%20%e6%ac%a1%e3%81%ab%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%8b%e3%82%89%e9%96%a2%e6%95%b0%e3%82%92%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e3%81%99%e3%82%8b%e3%81%93%e3%81%a8%e3%82%92%e8%80%83%e3%81%88%e3%81%be%e3%81%97%e3%82%87%e3%81%86%e3%80%82%24f%5csim%5cmathcal%7bGP%7d%28m%2ck%29%24%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%80%81%e7%89%b9%e3%81%ab%e3%81%8b%e3%82%93%e3%81%9f%e3%82%93%e3%81%ae%e3%81%9f%e3%82%81%e3%81%ab%e5%b9%b3%e5%9d%87%e3%82%92%240%24%e3%81%a8%e3%81%97%e3%81%a6%e3%81%8a%e3%81%8d%e3%81%be%e3%81%97%e3%82%87%e3%81%86%e3%80%82%20%e3%81%93%e3%81%ae%e3%81%a8%e3%81%8d%e3%80%81%24%5c%7bx_%7bi%7d%5c%7d_%7bi%3d1%7d%5e%7bn%7d%24%e4%b8%8a%e3%81%a7%e9%96%a2%e6%95%b0%24f%24%e3%81%ae%e3%83%99%e3%82%af%e3%83%88%e3%83%ab%24%5cbm%7bf%7d%24%e3%81%af%20%24%24%20%5cbm%7bf%7d%5csim%5cmathcal%7bN%7d%28%5cbm%7b0%7d%2cK%29%20%24%24%20%e3%81%a8%e3%81%84%e3%81%86%e5%a4%9a%e6%ac%a1%e5%85%83%e3%82%ac%e3%82%a6%e3%82%b9%e5%88%86%e5%b8%83%e3%81%ab%e5%be%93%e3%81%86%e3%82%82%e3%81%ae%e3%81%ab%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%e3%80%82%e3%81%93%e3%82%8c%e3%81%afGram%e8%a1%8c%e5%88%97%e3%82%92%e5%88%86%e6%95%a3%e5%85%b1%e5%88%86%e6%95%a3%e8%a1%8c%e5%88%97%e3%81%a8%e3%81%99%e3%82%8b%e3%82%ac%e3%82%a6%e3%82%b9%e5%88%86%e5%b8%83%e3%81%a7%e3%80%81%e4%bb%a3%e8%a1%a8%e7%9a%84%e3%81%aa%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e6%96%b9%e6%b3%95%e3%81%af%24K%24%e3%81%ae%e3%82%b3%e3%83%ac%e3%82%b9%e3%82%ad%e3%83%bc%e5%88%86%e8%a7%a3%e8%a1%8c%e5%88%97%e3%81%a8%24n%24%e6%ac%a1%e5%85%83%e3%81%ae%e7%8b%ac%e7%ab%8b%e6%a8%99%e6%ba%96%e6%ad%a3%e8%a6%8f%e5%88%86%e5%b8%83%e3%81%ab%e5%be%93%e3%81%86%e4%b9%b1%e6%95%b0%e3%81%a8%e3%81%ae%e8%a1%8c%e5%88%97%e3%83%bb%e3%83%99%e3%82%af%e3%83%88%e3%83%ab%e7%a9%8d%e3%82%92%e8%a8%88%e7%ae%97%e3%81%99%e3%82%8b%e3%81%93%e3%81%a8%e3%81%a7%e5%be%97%e3%82%89%e3%82%8c%e3%81%be%e3%81%99%e3%80%82%0a%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%a8%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%ae%e9%96%a2%e4%bf%82%20RBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%8b%e3%82%89Gram%e8%a1%8c%e5%88%97%e3%82%92%e7%94%9f%e6%88%90%e3%81%97%e3%80%81%e3%82%b3%e3%83%ac%e3%82%b9%e3%82%ad%e3%83%bc%e5%88%86%e8%a7%a3%e3%81%99%e3%82%8b%e3%81%93%e3%81%a8%e3%82%92%e8%80%83%e3%81%88%e3%81%be%e3%81%97%e3%82%87%e3%81%86%e3%80%82%e3%81%93%e3%81%93%e3%81%a7RBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%af%20%24%24%20k%28x%2cy%29%3d%5cexp%5cleft%28-%5cfrac%7b%28x-y%29%5e%7b2%7d%7d%7b2l%5e%7b2%7d%7d%5cright%29%20%24%24%20%e3%81%a7%e4%b8%8e%e3%81%88%e3%82%89%e3%82%8c%e3%81%be%e3%81%99%e3%80%82Julia%e5%ae%9f%e8%a3%85%e3%82%92%e3%81%97%e3%81%a6%e3%81%bf%e3%82%8b%e3%81%a8%e3%80%81%0ausing%20LinearAlgebra%20xs%20%3d%20-2%3a0.02%3a2%20K%20%3d%20%5bexp%28-%28x-y%29%5e2%29%20for%20x%20in%20xs%2c%20y%20in%20xs%5d%20cholesky%28K%29%20%e3%81%a8%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%e3%81%8c%e3%80%81%e3%81%93%e3%82%8c%e3%82%92%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8b%e3%81%a8%e3%80%81%0aERROR%3a%20PosDefException%3a%20matrix%20is%20not%20positive%20definite%3b%20Cholesky%20factorization%20failed.%20%e3%81%a8%e5%b8%b0%e3%81%a3%e3%81%a6%e3%81%8d%e3%81%a6%e3%80%81Gram%e8%a1%8c%e5%88%97%e3%81%8c%e6%ad%a3%e5%ae%9a%e5%80%a4%e3%81%a7%e3%81%aa%e3%81%84%e3%81%a8%e8%a8%80%e3%82%8f%e3%82%8c%e3%81%a6%e3%81%97%e3%81%be%e3%81%84%e3%81%be%e3%81%99%e3%80%82%e7%90%86%e8%ab%96%e3%81%a7%e3%81%afGram%e8%a1%8c%e5%88%97%e3%81%af%e6%ad%a3%e5%ae%9a%e5%80%a4%e3%81%a7%e3%81%82%e3%82%8b%e3%81%af%e3%81%9a%e3%81%aa%e3%81%ae%e3%81%a7%e3%80%81%e3%81%93%e3%82%8c%e3%81%af%e6%95%b0%e5%80%a4%e7%9a%84%e3%81%aa%e8%aa%a4%e5%b7%ae%e3%81%ab%e8%b5%b7%e5%9b%a0%e3%81%97%e3%81%a6%e3%81%84%e3%82%8b%e3%81%a8%e8%80%83%e3%81%88%e3%82%89%e3%82%8c%e3%81%be%e3%81%99%e3%80%82%20%e3%81%9d%e3%81%93%e3%81%a7Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%82%92%e7%a2%ba%e8%aa%8d%e3%81%97%e3%81%a6%e3%81%bf%e3%82%8b%e3%81%93%e3%81%a8%e3%81%ab%e3%81%97%e3%81%be%e3%81%99%e3%80%82%e3%81%93%e3%81%ae%e9%9a%9b%e3%80%81RBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%a0%e3%81%91%e3%81%a7%e3%81%aa%e3%81%8f%e5%91%a8%e6%9c%9f%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%a8Mat%c3%a9rn%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%82%82%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%a8%e5%af%be%e5%bf%9c%e3%81%99%e3%82%8b%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%ae%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e3%82%92%e3%83%97%e3%83%ad%e3%83%83%e3%83%88%e3%81%97%e3%81%be%e3%81%97%e3%81%9f%e3%80%82%e3%81%93%e3%81%ae%e7%b5%90%e6%9e%9c%e3%81%8c%e6%ac%a1%e3%81%ae%e3%82%88%e3%81%86%e3%81%ab%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%e3%80%82%0a%20%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%81%af%e9%99%8d%e9%a0%86%e3%81%ab%e3%82%bd%e3%83%bc%e3%83%88%e3%81%97%e3%81%9f%e3%82%82%e3%81%ae%e3%81%ae%e7%b5%b6%e5%af%be%e5%80%a4%e3%82%92%e3%81%a8%e3%81%a3%e3%81%9f%e3%82%82%e3%81%ae%e3%82%92%e3%83%97%e3%83%ad%e3%83%83%e3%83%88%e3%81%97%e3%81%a6%e3%81%84%e3%81%be%e3%81%99%e3%80%82%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%ae%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e6%96%b9%e6%b3%95%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%81%af%e5%be%8c%e8%bf%b0%e3%81%97%e3%81%be%e3%81%99%e3%80%82%0aRBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%a8%e5%91%a8%e6%9c%9f%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%ab%e7%9d%80%e7%9b%ae%e3%81%99%e3%82%8b%e3%81%a8%e3%80%81%e6%8c%87%e6%95%b0%e7%9a%84%e3%81%aa%e6%b8%9b%e8%a1%b0%e3%81%ae%e5%be%8c%e3%80%81%e9%80%94%e4%b8%ad%e3%81%a7%240%24%e3%82%92%e6%a8%aa%e5%88%87%e3%81%a3%e3%81%a6%e8%b2%a0%e3%81%ae%e5%80%a4%e3%82%92%e3%81%a8%e3%81%a3%e3%81%a6%e3%81%84%e3%82%8b%e3%81%93%e3%81%a8%e3%81%8c%e7%a2%ba%e8%aa%8d%e3%81%a7%e3%81%8d%e3%81%be%e3%81%99%e3%80%82%e3%81%93%e3%82%8c%e3%81%af%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%8c%e9%9d%9e%e5%b8%b8%e3%81%ab%e5%b0%8f%e3%81%95%e3%81%8f%e3%80%81%e6%95%b0%e5%80%a4%e7%9a%84%e3%81%aa%e8%aa%a4%e5%b7%ae%e3%81%ab%e3%82%88%e3%81%a3%e3%81%a6%e8%b2%a0%e3%81%a0%e3%81%a8%e5%87%ba%e5%8a%9b%e3%81%97%e3%81%a6%e3%81%97%e3%81%be%e3%81%a3%e3%81%9f%e3%82%b1%e3%83%bc%e3%82%b9%e3%81%a0%e3%81%a8%e8%80%83%e3%81%88%e3%82%8b%e3%81%93%e3%81%a8%e3%81%8c%e3%81%a7%e3%81%8d%e3%81%be%e3%81%99%e3%80%82%e4%b8%80%e6%96%b9%e3%81%a7%e3%80%81Mat%c3%a9rn%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%ab%e7%9d%80%e7%9b%ae%e3%81%99%e3%82%8b%e3%81%a8%e3%80%81%e3%83%99%e3%82%ad%e7%9a%84%e3%81%aa%e6%b8%9b%e8%a1%b0%e3%81%8c%e8%b5%b7%e3%81%93%e3%81%a3%e3%81%a6%e3%81%8a%e3%82%8a%e3%80%81%e8%b2%a0%e3%81%ae%e5%80%a4%e3%82%92%e5%8f%96%e3%82%8b%e7%ad%89%e3%81%ae%e8%aa%a4%e5%b7%ae%e3%81%8c%e8%a6%8b%e3%82%89%e3%82%8c%e3%82%8b%e3%82%8f%e3%81%91%e3%81%a7%e3%81%af%e3%81%82%e3%82%8a%e3%81%be%e3%81%9b%e3%82%93%e3%80%82">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&t=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#gram行列の性質">Gram行列の性質</a></li>
    <li><a href="#ガウス過程に従う関数の生成">ガウス過程に従う関数の生成</a></li>
    <li><a href="#固有値分布とガウス過程の関係">固有値分布とガウス過程の関係</a></li>
    <li><a href="#対応策">対応策(?)</a></li>
  </ul>
</nav>
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Gram行列の固有値の数値計算
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2021-08-02 16:59:14 &#43;0900 JST" itemprop="datePublished">2021-08-02</time>
          
        </div>
        
        
      </div>
    </header>


    <div class="content" itemprop="articleBody">
      <p>カーネル関数$k(\cdot,\cdot)$が与えられたとき、データ点$\{x_{i}\}_{i=1}^{n}$に対するGram行列(グラム行列)は
$$
K=\begin{pmatrix}k(x_{1},x_{1}) &amp; \cdots &amp; k(x_{1},x_{n})\\\vdots &amp; \ddots &amp; \vdots\\ k(x_{n},x_{1}) &amp; \cdots &amp; k(x_{n},x_{n})\end{pmatrix}
$$
で与えられます。色々な場面に登場するのですが、RBFカーネルからガウス過程を生成する際にその固有値計算で詰まったところがあったのでかんたんにまとめておきます。</p>
<h2 id="gram行列の性質">Gram行列の性質</h2>
<p>カーネル関数の定義は対称性$k(x,y)=k(y,x)$が成り立ってグラム行列が(半)正定値行列になることです。すなわち、任意のベクトル$\bm{c}$に対して、
$$
\bm{c}^{\top}K\bm{c}\geq0
$$
が成り立つことです。なので、カーネル関数から生成されたGram行列は常に半正定値行列になります。
半正定値性と固有値が非負であることは同値なのでGram行列の固有値は常に非負です。</p>
<h2 id="ガウス過程に従う関数の生成">ガウス過程に従う関数の生成</h2>
<p>次にガウス過程から関数をサンプルすることを考えましょう。$f\sim\mathcal{GP}(m,k)$について、特にかんたんのために平均を$0$としておきましょう。
このとき、$\{x_{i}\}_{i=1}^{n}$上で関数$f$のベクトル$\bm{f}$は
$$
\bm{f}\sim\mathcal{N}(\bm{0},K)
$$
という多次元ガウス分布に従うものになります。これはGram行列を分散共分散行列とするガウス分布で、代表的なサンプル方法は$K$のコレスキー分解行列と$n$次元の独立標準正規分布に従う乱数との行列・ベクトル積を計算することで得られます。</p>
<h2 id="固有値分布とガウス過程の関係">固有値分布とガウス過程の関係</h2>
<p>RBFカーネルからGram行列を生成し、コレスキー分解することを考えましょう。ここでRBFカーネルは
$$
k(x,y)=\exp\left(-\frac{(x-y)^{2}}{2l^{2}}\right)
$$
で与えられます。Julia実装をしてみると、</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> LinearAlgebra
xs <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0.02</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>
K <span style="color:#f92672">=</span> [exp(<span style="color:#f92672">-</span>(x<span style="color:#f92672">-</span>y)<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">for</span> x <span style="color:#66d9ef">in</span> xs, y <span style="color:#66d9ef">in</span> xs]
cholesky(K)
</code></pre></div><p>となりますが、これを実行すると、</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">ERROR<span style="color:#f92672">:</span> PosDefException<span style="color:#f92672">:</span> matrix is not positive definite; Cholesky factorization failed<span style="color:#f92672">.</span>
</code></pre></div><p>と帰ってきて、Gram行列が正定値でないと言われてしまいます。理論ではGram行列は正定値であるはずなので、これは数値的な誤差に起因していると考えられます。
そこでGram行列の固有値分布を確認してみることにします。この際、RBFカーネルだけでなく周期カーネルとMatérnカーネルについても固有値分布と対応するガウス過程のサンプルをプロットしました。この結果が次のようになります。</p>
<p><figure><img src="out.png"/>
</figure>

固有値分布については降順にソートしたものの絶対値をとったものをプロットしています。ガウス過程のサンプル方法については後述します。</p>
<p>RBFカーネルと周期カーネルの固有値分布に着目すると、指数的な減衰の後、途中で$0$を横切って負の値をとっていることが確認できます。これは固有値が非常に小さく、数値的な誤差によって負だと出力してしまったケースだと考えることができます。一方で、Matérnカーネルの固有値分布に着目すると、ベキ的な減衰が起こっており、負の値を取る等の誤差が見られるわけではありません。</p>
<p>次にガウス過程のサンプルに目を向けてみましょう。RBFカーネルと周期カーネルについては非常に滑らかな関数が出力されています。実際、RBFカーネルと周期カーネルから出力される関数は確率$1$で$C^{\infty}$級の関数がサンプルされることが知られています。一方で、Matérnカーネルについてはそこまで滑らかではない関数が出力されており、これは実際Matérnカーネルによりサンプルされる関数は有限回微分可能な関数になることにも一致します。</p>
<p>固有値分布とガウス過程の特徴についてそれぞれ確認しましたが、実はこの間には密接な関係があります。固有値分布の減衰が指数的である場合にはガウス過程から生成される関数は$C^{\infty}$級の滑らかさをもつことが知られています。一方で、減衰がベキ的な場合には関数は有限回微分可能な関数になることがわかっています。これらの事実は上の議論にも一致します。この結果を踏まえると、滑らかな関数を出力するカーネル関数は、固有値分布が指数的に減衰するため、数値的な誤差により負の固有値が生じやすくなります。そのため、コレスキー分解も失敗する可能性があります。以上がRBFカーネルのコレスキー分解が失敗した主な理由です。</p>
<h2 id="対応策">対応策(?)</h2>
<p>コレスキー分解にこだわらなければ、$K=M^{2}$となる対称行列$M$を見つけることで$M$と$n$次元の独立標準正規分布に従う乱数との行列・ベクトル積を計算することにより多次元ガウス分布を生成しても構いません。
実は行列のルートを計算するJulia実装の関数<code>sqrt</code>の内部実装では、非常に小さい負の固有値があればそれを$0$に置き換えて計算してくれるそうです。<a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#Base.sqrt">公式ページ</a>によると次のような説明があります。</p>
<blockquote>
<p>If <code>A</code> is real-symmetric or Hermitian, its eigendecomposition (eigen) is used to compute the square root. For such matrices, eigenvalues λ that appear to be slightly negative due to roundoff errors are treated as if they were zero More precisely, matrices with all eigenvalues <code>≥ -rtol*(max |λ|)</code> are treated as semidefinite (yielding a Hermitian square root), with negative eigenvalues taken to be zero. <code>rtol</code> is a keyword argument to <code>sqrt</code> (in the Hermitian/real-symmetric case only) that defaults to machine precision scaled by <code>size(A,1)</code>.</p>
</blockquote>
<p>十分に小さい負の固有値についてはゼロとしてしまっても(数値計算の上では)問題ないので、これを用いた計算をするならば、</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> LinearAlgebra
xs <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0.02</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>
K <span style="color:#f92672">=</span> [exp(<span style="color:#f92672">-</span>(x<span style="color:#f92672">-</span>y)<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">for</span> x <span style="color:#66d9ef">in</span> xs, y <span style="color:#66d9ef">in</span> xs]
println(sqrt(K)<span style="color:#f92672">*</span>randn(length(xs)))
</code></pre></div><p>で十分だと思います。</p>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/research">Research</a></li>
         
          <li><a href="/teaching">Teaching</a></li>
         
          <li><a href="/posts">Posts</a></li>
         
          <li><a href="/cv.pdf">CV</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#gram行列の性質">Gram行列の性質</a></li>
    <li><a href="#ガウス過程に従う関数の生成">ガウス過程に従う関数の生成</a></li>
    <li><a href="#固有値分布とガウス過程の関係">固有値分布とガウス過程の関係</a></li>
    <li><a href="#対応策">対応策(?)</a></li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&text=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&title=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&is_video=false&description=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97&body=Check out this article: https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&title=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&title=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&name=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97&description=%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e9%96%a2%e6%95%b0%24k%28%5ccdot%2c%5ccdot%29%24%e3%81%8c%e4%b8%8e%e3%81%88%e3%82%89%e3%82%8c%e3%81%9f%e3%81%a8%e3%81%8d%e3%80%81%e3%83%87%e3%83%bc%e3%82%bf%e7%82%b9%24%5c%7bx_%7bi%7d%5c%7d_%7bi%3d1%7d%5e%7bn%7d%24%e3%81%ab%e5%af%be%e3%81%99%e3%82%8bGram%e8%a1%8c%e5%88%97%28%e3%82%b0%e3%83%a9%e3%83%a0%e8%a1%8c%e5%88%97%29%e3%81%af%20%24%24%20K%3d%5cbegin%7bpmatrix%7dk%28x_%7b1%7d%2cx_%7b1%7d%29%20%26amp%3b%20%5ccdots%20%26amp%3b%20k%28x_%7b1%7d%2cx_%7bn%7d%29%5c%5c%5cvdots%20%26amp%3b%20%5cddots%20%26amp%3b%20%5cvdots%5c%5c%20k%28x_%7bn%7d%2cx_%7b1%7d%29%20%26amp%3b%20%5ccdots%20%26amp%3b%20k%28x_%7bn%7d%2cx_%7bn%7d%29%5cend%7bpmatrix%7d%20%24%24%20%e3%81%a7%e4%b8%8e%e3%81%88%e3%82%89%e3%82%8c%e3%81%be%e3%81%99%e3%80%82%e8%89%b2%e3%80%85%e3%81%aa%e5%a0%b4%e9%9d%a2%e3%81%ab%e7%99%bb%e5%a0%b4%e3%81%99%e3%82%8b%e3%81%ae%e3%81%a7%e3%81%99%e3%81%8c%e3%80%81RBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%8b%e3%82%89%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%82%92%e7%94%9f%e6%88%90%e3%81%99%e3%82%8b%e9%9a%9b%e3%81%ab%e3%81%9d%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e8%a8%88%e7%ae%97%e3%81%a7%e8%a9%b0%e3%81%be%e3%81%a3%e3%81%9f%e3%81%a8%e3%81%93%e3%82%8d%e3%81%8c%e3%81%82%e3%81%a3%e3%81%9f%e3%81%ae%e3%81%a7%e3%81%8b%e3%82%93%e3%81%9f%e3%82%93%e3%81%ab%e3%81%be%e3%81%a8%e3%82%81%e3%81%a6%e3%81%8a%e3%81%8d%e3%81%be%e3%81%99%e3%80%82%0aGram%e8%a1%8c%e5%88%97%e3%81%ae%e6%80%a7%e8%b3%aa%20%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e9%96%a2%e6%95%b0%e3%81%ae%e5%ae%9a%e7%be%a9%e3%81%af%e5%af%be%e7%a7%b0%e6%80%a7%24k%28x%2cy%29%3dk%28y%2cx%29%24%e3%81%8c%e6%88%90%e3%82%8a%e7%ab%8b%e3%81%a3%e3%81%a6%e3%82%b0%e3%83%a9%e3%83%a0%e8%a1%8c%e5%88%97%e3%81%8c%28%e5%8d%8a%29%e6%ad%a3%e5%ae%9a%e5%80%a4%e8%a1%8c%e5%88%97%e3%81%ab%e3%81%aa%e3%82%8b%e3%81%93%e3%81%a8%e3%81%a7%e3%81%99%e3%80%82%e3%81%99%e3%81%aa%e3%82%8f%e3%81%a1%e3%80%81%e4%bb%bb%e6%84%8f%e3%81%ae%e3%83%99%e3%82%af%e3%83%88%e3%83%ab%24%5cbm%7bc%7d%24%e3%81%ab%e5%af%be%e3%81%97%e3%81%a6%e3%80%81%20%24%24%20%5cbm%7bc%7d%5e%7b%5ctop%7dK%5cbm%7bc%7d%5cgeq0%20%24%24%20%e3%81%8c%e6%88%90%e3%82%8a%e7%ab%8b%e3%81%a4%e3%81%93%e3%81%a8%e3%81%a7%e3%81%99%e3%80%82%e3%81%aa%e3%81%ae%e3%81%a7%e3%80%81%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e9%96%a2%e6%95%b0%e3%81%8b%e3%82%89%e7%94%9f%e6%88%90%e3%81%95%e3%82%8c%e3%81%9fGram%e8%a1%8c%e5%88%97%e3%81%af%e5%b8%b8%e3%81%ab%e5%8d%8a%e6%ad%a3%e5%ae%9a%e5%80%a4%e8%a1%8c%e5%88%97%e3%81%ab%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%e3%80%82%20%e5%8d%8a%e6%ad%a3%e5%ae%9a%e5%80%a4%e6%80%a7%e3%81%a8%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%8c%e9%9d%9e%e8%b2%a0%e3%81%a7%e3%81%82%e3%82%8b%e3%81%93%e3%81%a8%e3%81%af%e5%90%8c%e5%80%a4%e3%81%aa%e3%81%ae%e3%81%a7Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%af%e5%b8%b8%e3%81%ab%e9%9d%9e%e8%b2%a0%e3%81%a7%e3%81%99%e3%80%82%0a%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%ab%e5%be%93%e3%81%86%e9%96%a2%e6%95%b0%e3%81%ae%e7%94%9f%e6%88%90%20%e6%ac%a1%e3%81%ab%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%8b%e3%82%89%e9%96%a2%e6%95%b0%e3%82%92%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e3%81%99%e3%82%8b%e3%81%93%e3%81%a8%e3%82%92%e8%80%83%e3%81%88%e3%81%be%e3%81%97%e3%82%87%e3%81%86%e3%80%82%24f%5csim%5cmathcal%7bGP%7d%28m%2ck%29%24%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%80%81%e7%89%b9%e3%81%ab%e3%81%8b%e3%82%93%e3%81%9f%e3%82%93%e3%81%ae%e3%81%9f%e3%82%81%e3%81%ab%e5%b9%b3%e5%9d%87%e3%82%92%240%24%e3%81%a8%e3%81%97%e3%81%a6%e3%81%8a%e3%81%8d%e3%81%be%e3%81%97%e3%82%87%e3%81%86%e3%80%82%20%e3%81%93%e3%81%ae%e3%81%a8%e3%81%8d%e3%80%81%24%5c%7bx_%7bi%7d%5c%7d_%7bi%3d1%7d%5e%7bn%7d%24%e4%b8%8a%e3%81%a7%e9%96%a2%e6%95%b0%24f%24%e3%81%ae%e3%83%99%e3%82%af%e3%83%88%e3%83%ab%24%5cbm%7bf%7d%24%e3%81%af%20%24%24%20%5cbm%7bf%7d%5csim%5cmathcal%7bN%7d%28%5cbm%7b0%7d%2cK%29%20%24%24%20%e3%81%a8%e3%81%84%e3%81%86%e5%a4%9a%e6%ac%a1%e5%85%83%e3%82%ac%e3%82%a6%e3%82%b9%e5%88%86%e5%b8%83%e3%81%ab%e5%be%93%e3%81%86%e3%82%82%e3%81%ae%e3%81%ab%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%e3%80%82%e3%81%93%e3%82%8c%e3%81%afGram%e8%a1%8c%e5%88%97%e3%82%92%e5%88%86%e6%95%a3%e5%85%b1%e5%88%86%e6%95%a3%e8%a1%8c%e5%88%97%e3%81%a8%e3%81%99%e3%82%8b%e3%82%ac%e3%82%a6%e3%82%b9%e5%88%86%e5%b8%83%e3%81%a7%e3%80%81%e4%bb%a3%e8%a1%a8%e7%9a%84%e3%81%aa%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e6%96%b9%e6%b3%95%e3%81%af%24K%24%e3%81%ae%e3%82%b3%e3%83%ac%e3%82%b9%e3%82%ad%e3%83%bc%e5%88%86%e8%a7%a3%e8%a1%8c%e5%88%97%e3%81%a8%24n%24%e6%ac%a1%e5%85%83%e3%81%ae%e7%8b%ac%e7%ab%8b%e6%a8%99%e6%ba%96%e6%ad%a3%e8%a6%8f%e5%88%86%e5%b8%83%e3%81%ab%e5%be%93%e3%81%86%e4%b9%b1%e6%95%b0%e3%81%a8%e3%81%ae%e8%a1%8c%e5%88%97%e3%83%bb%e3%83%99%e3%82%af%e3%83%88%e3%83%ab%e7%a9%8d%e3%82%92%e8%a8%88%e7%ae%97%e3%81%99%e3%82%8b%e3%81%93%e3%81%a8%e3%81%a7%e5%be%97%e3%82%89%e3%82%8c%e3%81%be%e3%81%99%e3%80%82%0a%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%a8%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%ae%e9%96%a2%e4%bf%82%20RBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%8b%e3%82%89Gram%e8%a1%8c%e5%88%97%e3%82%92%e7%94%9f%e6%88%90%e3%81%97%e3%80%81%e3%82%b3%e3%83%ac%e3%82%b9%e3%82%ad%e3%83%bc%e5%88%86%e8%a7%a3%e3%81%99%e3%82%8b%e3%81%93%e3%81%a8%e3%82%92%e8%80%83%e3%81%88%e3%81%be%e3%81%97%e3%82%87%e3%81%86%e3%80%82%e3%81%93%e3%81%93%e3%81%a7RBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%af%20%24%24%20k%28x%2cy%29%3d%5cexp%5cleft%28-%5cfrac%7b%28x-y%29%5e%7b2%7d%7d%7b2l%5e%7b2%7d%7d%5cright%29%20%24%24%20%e3%81%a7%e4%b8%8e%e3%81%88%e3%82%89%e3%82%8c%e3%81%be%e3%81%99%e3%80%82Julia%e5%ae%9f%e8%a3%85%e3%82%92%e3%81%97%e3%81%a6%e3%81%bf%e3%82%8b%e3%81%a8%e3%80%81%0ausing%20LinearAlgebra%20xs%20%3d%20-2%3a0.02%3a2%20K%20%3d%20%5bexp%28-%28x-y%29%5e2%29%20for%20x%20in%20xs%2c%20y%20in%20xs%5d%20cholesky%28K%29%20%e3%81%a8%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%e3%81%8c%e3%80%81%e3%81%93%e3%82%8c%e3%82%92%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8b%e3%81%a8%e3%80%81%0aERROR%3a%20PosDefException%3a%20matrix%20is%20not%20positive%20definite%3b%20Cholesky%20factorization%20failed.%20%e3%81%a8%e5%b8%b0%e3%81%a3%e3%81%a6%e3%81%8d%e3%81%a6%e3%80%81Gram%e8%a1%8c%e5%88%97%e3%81%8c%e6%ad%a3%e5%ae%9a%e5%80%a4%e3%81%a7%e3%81%aa%e3%81%84%e3%81%a8%e8%a8%80%e3%82%8f%e3%82%8c%e3%81%a6%e3%81%97%e3%81%be%e3%81%84%e3%81%be%e3%81%99%e3%80%82%e7%90%86%e8%ab%96%e3%81%a7%e3%81%afGram%e8%a1%8c%e5%88%97%e3%81%af%e6%ad%a3%e5%ae%9a%e5%80%a4%e3%81%a7%e3%81%82%e3%82%8b%e3%81%af%e3%81%9a%e3%81%aa%e3%81%ae%e3%81%a7%e3%80%81%e3%81%93%e3%82%8c%e3%81%af%e6%95%b0%e5%80%a4%e7%9a%84%e3%81%aa%e8%aa%a4%e5%b7%ae%e3%81%ab%e8%b5%b7%e5%9b%a0%e3%81%97%e3%81%a6%e3%81%84%e3%82%8b%e3%81%a8%e8%80%83%e3%81%88%e3%82%89%e3%82%8c%e3%81%be%e3%81%99%e3%80%82%20%e3%81%9d%e3%81%93%e3%81%a7Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%82%92%e7%a2%ba%e8%aa%8d%e3%81%97%e3%81%a6%e3%81%bf%e3%82%8b%e3%81%93%e3%81%a8%e3%81%ab%e3%81%97%e3%81%be%e3%81%99%e3%80%82%e3%81%93%e3%81%ae%e9%9a%9b%e3%80%81RBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%a0%e3%81%91%e3%81%a7%e3%81%aa%e3%81%8f%e5%91%a8%e6%9c%9f%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%a8Mat%c3%a9rn%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%82%82%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%a8%e5%af%be%e5%bf%9c%e3%81%99%e3%82%8b%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%ae%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e3%82%92%e3%83%97%e3%83%ad%e3%83%83%e3%83%88%e3%81%97%e3%81%be%e3%81%97%e3%81%9f%e3%80%82%e3%81%93%e3%81%ae%e7%b5%90%e6%9e%9c%e3%81%8c%e6%ac%a1%e3%81%ae%e3%82%88%e3%81%86%e3%81%ab%e3%81%aa%e3%82%8a%e3%81%be%e3%81%99%e3%80%82%0a%20%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%81%af%e9%99%8d%e9%a0%86%e3%81%ab%e3%82%bd%e3%83%bc%e3%83%88%e3%81%97%e3%81%9f%e3%82%82%e3%81%ae%e3%81%ae%e7%b5%b6%e5%af%be%e5%80%a4%e3%82%92%e3%81%a8%e3%81%a3%e3%81%9f%e3%82%82%e3%81%ae%e3%82%92%e3%83%97%e3%83%ad%e3%83%83%e3%83%88%e3%81%97%e3%81%a6%e3%81%84%e3%81%be%e3%81%99%e3%80%82%e3%82%ac%e3%82%a6%e3%82%b9%e9%81%8e%e7%a8%8b%e3%81%ae%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e6%96%b9%e6%b3%95%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%81%af%e5%be%8c%e8%bf%b0%e3%81%97%e3%81%be%e3%81%99%e3%80%82%0aRBF%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%a8%e5%91%a8%e6%9c%9f%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%ab%e7%9d%80%e7%9b%ae%e3%81%99%e3%82%8b%e3%81%a8%e3%80%81%e6%8c%87%e6%95%b0%e7%9a%84%e3%81%aa%e6%b8%9b%e8%a1%b0%e3%81%ae%e5%be%8c%e3%80%81%e9%80%94%e4%b8%ad%e3%81%a7%240%24%e3%82%92%e6%a8%aa%e5%88%87%e3%81%a3%e3%81%a6%e8%b2%a0%e3%81%ae%e5%80%a4%e3%82%92%e3%81%a8%e3%81%a3%e3%81%a6%e3%81%84%e3%82%8b%e3%81%93%e3%81%a8%e3%81%8c%e7%a2%ba%e8%aa%8d%e3%81%a7%e3%81%8d%e3%81%be%e3%81%99%e3%80%82%e3%81%93%e3%82%8c%e3%81%af%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%8c%e9%9d%9e%e5%b8%b8%e3%81%ab%e5%b0%8f%e3%81%95%e3%81%8f%e3%80%81%e6%95%b0%e5%80%a4%e7%9a%84%e3%81%aa%e8%aa%a4%e5%b7%ae%e3%81%ab%e3%82%88%e3%81%a3%e3%81%a6%e8%b2%a0%e3%81%a0%e3%81%a8%e5%87%ba%e5%8a%9b%e3%81%97%e3%81%a6%e3%81%97%e3%81%be%e3%81%a3%e3%81%9f%e3%82%b1%e3%83%bc%e3%82%b9%e3%81%a0%e3%81%a8%e8%80%83%e3%81%88%e3%82%8b%e3%81%93%e3%81%a8%e3%81%8c%e3%81%a7%e3%81%8d%e3%81%be%e3%81%99%e3%80%82%e4%b8%80%e6%96%b9%e3%81%a7%e3%80%81Mat%c3%a9rn%e3%82%ab%e3%83%bc%e3%83%8d%e3%83%ab%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e5%88%86%e5%b8%83%e3%81%ab%e7%9d%80%e7%9b%ae%e3%81%99%e3%82%8b%e3%81%a8%e3%80%81%e3%83%99%e3%82%ad%e7%9a%84%e3%81%aa%e6%b8%9b%e8%a1%b0%e3%81%8c%e8%b5%b7%e3%81%93%e3%81%a3%e3%81%a6%e3%81%8a%e3%82%8a%e3%80%81%e8%b2%a0%e3%81%ae%e5%80%a4%e3%82%92%e5%8f%96%e3%82%8b%e7%ad%89%e3%81%ae%e8%aa%a4%e5%b7%ae%e3%81%8c%e8%a6%8b%e3%82%89%e3%82%8c%e3%82%8b%e3%82%8f%e3%81%91%e3%81%a7%e3%81%af%e3%81%82%e3%82%8a%e3%81%be%e3%81%9b%e3%82%93%e3%80%82">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fyonesuke.github.io%2fposts%2fgram_eigen%2f&t=Gram%e8%a1%8c%e5%88%97%e3%81%ae%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%ae%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  Ryosuke Yoneda 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/about">About</a></li>
         
        <li><a href="/research">Research</a></li>
         
        <li><a href="/teaching">Teaching</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/cv.pdf">CV</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css" integrity="sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js" integrity="sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "$", right: "$", display: false}]
    });
  });
</script>

  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>



</html>
